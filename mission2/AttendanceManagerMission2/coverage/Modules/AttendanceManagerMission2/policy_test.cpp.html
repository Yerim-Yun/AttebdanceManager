<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>policy_test.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
#include "policy.h"
#include "player.h"
#include "gmock/gmock.h"

using namespace testing;

class PolicyFixture : public ::testing::Test {
public:
<span style = "background-color:#dfd">	void SetUp() override {
		player = new Player("TestPlayer");
	}
	void setPolicy(IPolicy* policy) {
		this-&gt;policy = policy;
	}</span>
	Player* player;
	IPolicy* policy = nullptr;
};

<span style = "background-color:#dfd">TEST_F(PolicyFixture, getPointPerDay_test){
	DayPointPolicy policy;
	EXPECT_EQ(policy.getPointPerDay(MONDAY), 1);
	EXPECT_EQ(policy.getPointPerDay(TUESDAY), 1);
	EXPECT_EQ(policy.getPointPerDay(WEDNESDAY), 3);
	EXPECT_EQ(policy.getPointPerDay(THURSDAY), 1);
	EXPECT_EQ(policy.getPointPerDay(FRIDAY), 1);
	EXPECT_EQ(policy.getPointPerDay(SATURDAY), 2);
	EXPECT_EQ(policy.getPointPerDay(SUNDAY), 2);
	EXPECT_EQ(policy.getPointPerDay(7), 0); // Invalid day
}</span>

<span style = "background-color:#dfd">TEST_F(PolicyFixture, DayApplyTest) {
	setPolicy(new DayPointPolicy());
	player-&gt;addAttendance(MONDAY); // 1
	player-&gt;addAttendance(TUESDAY); // 1
	player-&gt;addAttendance(WEDNESDAY); // 3
	player-&gt;addAttendance(THURSDAY); // 1
	player-&gt;addAttendance(FRIDAY); // 1
	player-&gt;addAttendance(SATURDAY); // 2
	player-&gt;addAttendance(SUNDAY); // 2
	policy-&gt;apply(*player);
	EXPECT_EQ(player-&gt;getPoints(), 1 + 1 + 3 + 1 + 1 + 2 + 2); // Total points should be 11
}</span>

<span style = "background-color:#dfd">TEST_F(PolicyFixture, BonusApplyTestWednesdayCase) {
	setPolicy(new BonusPointPolicy());</span>
	// Simulate attendance
<span style = "background-color:#dfd">	player-&gt;addAttendance(WEDNESDAY); // 10 times
	for (int i = 0; i &lt; 10; ++i) {
		player-&gt;addAttendance(WEDNESDAY);
	}
	policy-&gt;apply(*player);
	EXPECT_EQ(player-&gt;getPoints(), 10);
}</span>

<span style = "background-color:#dfd">TEST_F(PolicyFixture, BonusApplyTestWeekendCase) {
	setPolicy(new BonusPointPolicy());</span>

<span style = "background-color:#dfd">	player-&gt;addAttendance(SATURDAY); // 5 times
	for (int i = 0; i &lt; 5; ++i) {
		player-&gt;addAttendance(SATURDAY);
	}
	player-&gt;addAttendance(SUNDAY); // 5 times
	for (int i = 0; i &lt; 5; ++i) {
		player-&gt;addAttendance(SUNDAY);
	}
	policy-&gt;apply(*player);
	EXPECT_EQ(player-&gt;getPoints(), 10);
}</span>

<span style = "background-color:#dfd">TEST_F(PolicyFixture, GradeApplyTest) {
	vector&lt;IGrade*&gt; grades = {</span>
		new NormalGrade(),
		new SilverGrade(),
		new GoldGrade(),
	};
<span style = "background-color:#dfd">	setPolicy(new GradePolicy(grades));
	player-&gt;addPoints(10);
	policy-&gt;apply(*player);
	EXPECT_EQ(player-&gt;getGradeName(), "NORMAL");
	player-&gt;addPoints(20);
	policy-&gt;apply(*player);
	EXPECT_EQ(player-&gt;getGradeName(), "SILVER");
	player-&gt;addPoints(30);
	policy-&gt;apply(*player);
	EXPECT_EQ(player-&gt;getGradeName(), "GOLD");
}</span></pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>